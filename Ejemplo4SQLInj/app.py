from flask import Flask, request, render_template
import mysql.connector

app = Flask(__name__)


DATABASE = {
    'host': 'localhost',
    'user': 'root',
    'password': 'admin',
    'database': 'doctorado'
}


def get_db():
    return mysql.connector.connect(**DATABASE)

@app.route('/', methods=['GET', 'POST'])
def index():
    message = None
    if request.method == 'POST':

        nombre = request.form['nombre']
        
        # Consulta SQL para buscar usuarios en la tabla usuarios << AQUI ESTA EL SQL INJECTION
        consulta = "SELECT * FROM usuarios WHERE nombre = '"+nombre+"'"

 
        db = get_db()
        cursor = db.cursor()
        cursor.execute(consulta)
        usuarios = cursor.fetchall()
        db.close()


        message = f"Resultados para '{nombre}': {usuarios}"

    return render_template('index.html', message=message)

if __name__ == '__main__':
    app.run(debug=True)